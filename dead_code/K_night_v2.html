<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-Night - Fixed Reader</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --paper-color: #FdfcF0;
            --ink-color: #333333;
            --ui-bg: #F4F1EA;
            --font-main: 'Crimson Text', serif;
            --base-size: 20px;
            --line-height: 1.6;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0; padding: 0;
            background-color: #3b3b3b;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh;
            font-family: var(--font-main);
        }

        #reader-container {
            background-color: var(--paper-color);
            width: 100%;
            max-width: 550px;
            height: 95vh;
            max-height: 900px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border-radius: 6px;
            position: relative;
        }

        header {
            padding: 10px 20px;
            font-size: 0.9rem;
            color: #888;
            display: flex; justify-content: space-between;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            flex-shrink: 0; font-family: sans-serif;
        }

        /* --- LAYOUT AREA --- */
        #page-viewport {
            flex-grow: 1;
            position: relative;
            padding: 40px 50px;
            overflow: hidden; /* No scrolling allowed */
        }

        /* The text the user sees */
        #visible-content {
            height: 100%;
            width: 100%;
            color: var(--ink-color);
            font-size: var(--base-size);
            line-height: var(--line-height);
            text-align: justify;
        }

        /* The invisible testing laboratory */
        #measure-chamber {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            /* IMPORTANT: No fixed height here, we measure its growth */
            visibility: hidden;
            z-index: -100;
            padding: 40px 50px; /* MUST match viewport padding exactly */
            font-size: var(--base-size);
            line-height: var(--line-height);
        }

        /* --- TYPOGRAPHY --- */
        h1, h2, p, .dialogue-line { margin-bottom: 0.5em; margin-top: 0; }

        h1.chapter-num {
            text-align: center; font-size: 1.2em;
            text-transform: uppercase; color: #666; margin-top: 10px;
        }
        h2.chapter-title {
            text-align: center; font-size: 2.2em;
            margin-bottom: 30px; color: #111;
        }
        .speaker { font-weight: bold; font-variant: small-caps; margin-right: 5px; }
        .scene-break { text-align: center; margin: 20px 0; color: #888; letter-spacing: 3px; }

        /* --- CONTROLS --- */
        #controls {
            background-color: var(--ui-bg);
            border-top: 1px solid #e0e0e0;
            padding: 20px 30px;
            display: flex; flex-direction: column; gap: 15px;
            flex-shrink: 0;
        }
        .read-btn {
            background-color: var(--ink-color); color: var(--paper-color);
            border: none; padding: 15px; font-family: var(--font-main);
            font-size: 1.1rem; cursor: pointer; border-radius: 4px; width: 100%;
        }
        .read-btn:disabled { background-color: #aaa; cursor: not-allowed; }
        .secondary-controls { display: flex; justify-content: space-between; align-items: center; }
        .text-btn {
            background: none; border: 1px solid #ccc; color: #555;
            padding: 5px 12px; border-radius: 4px; cursor: pointer;
            font-family: sans-serif; font-size: 0.8rem;
            display: flex; align-items: center; gap: 5px;
        }
        .back-btn {
            background: none; border: none; color: #666; cursor: pointer;
            font-family: var(--font-main); font-size: 1rem; text-decoration: underline;
        }

        @media (max-width: 600px) {
            #reader-container { height: 100vh; max-height: none; border-radius: 0; }
            #page-viewport, #measure-chamber { padding: 30px 25px; }
        }
    </style>
</head>
<body>

    <div id="reader-container">
        <header>
            <span><a href="index.html">My Library</a></span>
            <span>Page <span id="page-num">1</span> / <span id="total-pages">--</span></span>
        </header>

        <div id="page-viewport">
            <div id="visible-content"></div>
            <div id="measure-chamber"></div>
        </div>

        <div id="controls">
            <button id="btn-next" class="read-btn" onclick="turnPage(1)">Turn Page</button>
            <div class="secondary-controls">
                <button id="btn-prev" class="back-btn" onclick="turnPage(-1)">Back</button>
                <div style="display:flex; gap:5px;">
                    <button class="text-btn" onclick="resizeFont(-2)"><i data-lucide="minus" width="14"></i> A</button>
                    <button class="text-btn" onclick="resizeFont(2)">A <i data-lucide="plus" width="14"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const rawStoryHTML = `
            <h1 class="chapter-num">Short Story</h1>
            <h2 class="chapter-title">K-Night ğŸ±ğŸŒ•</h2>
            <p style="text-align: center; margin-bottom: 20px;">By Eloise Martin</p>

            <p>Hi, I'm Heather, and this is my amazing story.</p>
            <p>I was walking through the store, shopping for three tomatoes, a bag of popcorn, one green onion, and some tea.</p>
            <p>Walking out of the store holding the green onion, I saw an adult Bengal cat in a tree, and a dog was barking up at the cat trying to climb the tree.</p>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œGo away, get it, go!â€</div>

            <p><em>Why does the cat have a bandage wrapped all around its tail?</em> I wondered.</p>
            <p>Heather extended her arms to the cat, and the cat jumped down from the tree into her arms. I set the Bengal cat down on the ground. She then took the bandage off of the catâ€™s tail and to Heather's surprise, just when she peeled it off, a row of white neon dots were all around the tail!</p>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWow, that's a cool bald spot.â€</div>
            <p>I stared in awe.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œGAAAAAA! I'm late! Bye, kitty!! Omg, omg, omg!â€</div>

            <div class="scene-break">***</div>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œMom I'm back and I got the groceries.â€</div>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œGood you came back, it's almost time for the party.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œUgggh can I just stay in my room and then come back when the party's over?â€</div>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œNo, and I need you to get dressed. I need to get your little brother ready and finish cleaning.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOk, see ya Mom.â€</div>

            <p>In my room I got two dresses to pick from: a pink long elegant one, or an orange dress with a butterfly on one hand. I can look fancy for the partyâ€”Mom wants everything to be perfectâ€”or on the other hand, something cute and classic.</p>
            <p><em>Uhhhhh? How about...</em></p>
            <p style="text-align:center; font-style:italic;">DING DONG!!!!</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œI will get it! Malory, why are you here?â€</div>
            <div class="dialogue-line"><span class="speaker">Malory:</span> â€œTo help you get ready for your party. You asked me to come yesterday.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOh yes thank you for coming, Mal.â€</div>
            <div class="dialogue-line"><span class="speaker">Malory:</span> â€œI'll get the hair supply and makeup.â€</div>

            <p>I got ready for the party my Mom is throwing. I picked the orange dress and went up to my room once Malory left. I picked up my drawing pad and drew a cute cat girl fighting a dark, evil villain. <em>If only it was real,</em> I thought.</p>

            <div class="dialogue-line"><span class="speaker">???:</span> â€œHello, Heather.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWho said that?â€</div>
            <div class="dialogue-line"><span class="speaker">???:</span> â€œMe. My name is Lemon.â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œThank you for the kindness. A week ago some boys were picking on me and putting a bandage on my tail because it was covered up. I wasn't able to talk but you came!â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œSo a talking cat just comes up to my window and is thanking me!? This has to be a dream!!â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œNope, not a dream. But anyways I need to get going but I will meet you at night at your window to talk. Bye mew!â€</div>

            <p><em>*jumps out window*</em></p>

            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œStrange! Heather come down here it's almost time for the party!â€ my Mom yelled to me.</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œComing!â€ I shouted back.</div>

            <p>I got to hurry up and put my drawing pad away and hide my journal before they come and see my room. They always get a tour of the houseâ€“even my room.</p>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œIâ€™m here, Mom.â€</div>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œCan you watch your brother Hunter? I can't let him eat all the candy for the guests.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOk, Hunter come here!â€</div>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œNot if you get me hehe!â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œCome back here!â€</div>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œGo get your brother now.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œYes Mom.â€</div>

            <p>I saw him run upstairs. I checked the bathroom, bedrooms, and the old dusty attic but nowhere to be seen. The last place I need to check is the closets.</p>
            <p>I checked my closet, Mom and Dad's closet, not there. Getting worried, I checked the basement to check if he ran down there behind my back. I looked every place in the house but nowhere to be seen.</p>
            <p>Getting worried, I told Mom about it. Just when she was going to reply with a worried look, the doorbell rang. I went to get it. Not to my surprise it was my Aunt Lia. She always comes first to anywhere.</p>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œHi, come in.â€</div>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œOh. Lia hi! How are you? We're trying to find Hunter. He is somewhere in the house.â€</div>
            <div class="dialogue-line"><span class="speaker">Aunt Lia:</span> â€œOh the boy hiding well maybe if I bring Bobby here he will come down. Come on give it a try. Bobby come here you wanted to see Hunter, right?â€</div>
            <div class="dialogue-line"><span class="speaker">Bobby:</span> â€œYes, yes, yes, yes yessssssssssssssss!â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œAnd you want to see me right?â€</div>
            <div class="dialogue-line"><span class="speaker">Bobby:</span> â€œUhh. Ok yeah.â€</div>

            <p>Hunter finally comes down.</p>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œWhere were you?â€</div>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œIn the attic.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œBut I checked there!â€</div>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œI was hiding in the small corner behind the boxes.â€</div>

            <p>Then they ran off to play.</p>

            <div class="scene-break">***</div>
            <p>But then I see the same cat walking down the sidewalk.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œ(gasp) Lemon,â€ she said in a soft, quiet voice.</div>
            <div class="dialogue-line"><span class="speaker">Aunt Lia:</span> â€œLemons? Oh, did your Mom tell you how me, your mother and your grandma are making Lemonade?â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œUmm yes, one sec I see something outside.â€</div>
            <div class="dialogue-line"><span class="speaker">Mom:</span> â€œOk, but come back quickly don't go too far.â€</div>

            <p>As I run outside I go to where Lemon is sitting down.</p>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œI heard you're having a party.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWhat are you doing here! Yes and you are not invited.â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œSo what, can I just watch from a distance? I want to protect you at all times.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOk just do not show yourself.â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œOk, ok. But if they see me, I will just be invisible by using the power in my tail.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œHow does that work?â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œYou know how I can talk? Well, I can do many other cool magic abilities.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOk, cool just keep hidden. Ok I need to go bye.â€</div>

            <p>As I went back to my house I saw Lemon going behind a bush.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œI'm back.â€</div>
            <div class="dialogue-line"><span class="speaker">Dad:</span> â€œAnd in front! Ha ha ha.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather, Mom, Lia:</span> â€œPlease don't do that again.â€</div>

            <p style="text-align:center; font-style:italic;">DING DONG DING DONG DING DONNING</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWho needs to ring the doorbell that much?â€</div>

            <p>Mom opens the door. Dad, Mom and me see Grace and Jake with their parents, my aunt and uncle.</p>
            <div class="dialogue-line"><span class="speaker">Dad:</span> â€œAhh brother, how is it going?â€</div>
            <div class="dialogue-line"><span class="speaker">Uncle Jon:</span> â€œGood. Sorry Grace keeps on pressing the doorbell.â€</div>
            <div class="dialogue-line"><span class="speaker">Grace:</span> â€œGuess what guess what! Heather!â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWhat is it?â€</div>

            <p>Grace is my sweet 6 year old cousin. She loves animals and has brown hair like her Mom.</p>
            <div class="dialogue-line"><span class="speaker">Grace:</span> â€œYesterday I saw a kitty.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œAww that's sweet. Which color was the kitty?â€</div>
            <div class="dialogue-line"><span class="speaker">Grace:</span> â€œIt was gray with a really bright star on the back of its ear.â€</div>
            <p><em>But Lemon has a mark on her tail too,</em> I thought.</p>
            <div class="dialogue-line"><span class="speaker">Grace:</span> â€œDo you want to see him?â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œSure, one day.â€</div>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œSup, Jake.â€</div>
            <div class="dialogue-line"><span class="speaker">Jake:</span> â€œSup.â€</div>
            <p>Jake is 15 years old and loves playing video games all the time. And of course he went back to his phone after he said hi.</p>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œHi Uncle Jon and Aunt Sofie.â€</div>
            <div class="dialogue-line"><span class="speaker">Aunt Sofie:</span> â€œHello, wow you grew 3 inches taller since I saw you. Wow!â€</div>
            <div class="dialogue-line"><span class="speaker">Uncle Jon:</span> â€œReally? She looks the same.â€</div>
            <div class="dialogue-line"><span class="speaker">Aunt Sofie:</span> â€œYou can not tell anything apart, Jon.â€</div>

            <p>Grace and I went to my bedroom and played for a bit. Then the doorbell rang again. It was Grandpa and Grandma.</p>

            <div class="scene-break">***</div>
            <p>We talked for a bit, everyone else came, and we started the party. But then...</p>
            <p style="text-align:center; font-weight:bold; font-size:1.2em;">WAM!!!</p>
            <p>The entire house shook. Me and my Dad went down and we weren't the only ones that felt it.</p>
            <div class="dialogue-line"><span class="speaker">Grandma:</span> â€œWhoa! Ahh!â€</div>
            <p>I caught her just in time.</p>
            <p><em>Waaah waaah ahhhh!!!</em> My baby cousin cried.</p>
            <p>Then it stopped.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWhat was that?!â€</div>

            <p>I see Lemon pass by looking at me like I need to follow her. So I say I need to go and ran to Lemon.</p>

            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWhat's going on!â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œI don't know. It looks like an earthquake, but it can't be one. It can't happen in this place. It's impossible.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œThen what?!â€</div>

            <p>It rumbled again. I saw others falling on the floor then it all went blank.</p>
            <p>When I woke up the town looked empty.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œMom? Dad? Hunter? Anyone?! Lemon!!!!!!!!!!â€</div>

            <p>To my relief, Hunter came out and then Lemon.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOmg, Hunter what happened!â€</div>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œI don't know it all happened so quick.â€</div>
            <p>He said halfway through tears. Lemon didn't say anything she just meowed.</p>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œWhy is there a cat?â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œUhhmm it's just a cat I know I named her Lemon.â€</div>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œWOW, cool!â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œWe should look around for anyone.â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> â€œMeow.â€</div>

            <p>We checked other houses, but we didn't find anyone so we went inside our house to get supplies.</p>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œWill we see Mommy, Daddy, or maybe even Bobby?â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œI don't know. Are you hungry?â€</div>
            <div class="dialogue-line"><span class="speaker">Hunter:</span> â€œYep, so hungry.â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œOk come on let's go eat.â€</div>

            <p>We ate some snacks, and I tried using my phone.</p>
            <p><em>Please work please worrrrkk!</em></p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œYess yess it works!! I'm going to try calling Mom or Dad.â€</div>
            <p>No one answered besides my friend.</p>
            <p style="text-align:center;"><em>Ring ring...</em></p>
            <div class="dialogue-line"><span class="speaker">Malory:</span> â€œHeather, where are you?â€</div>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œAt my house. Did you see outside? It looks like trash.â€</div>
            <div class="dialogue-line"><span class="speaker">Malory:</span> â€œHow can I miss it? I'm outside of my door. I'm on my way now, ok stay there.â€</div>

            <div class="scene-break">*** A few minutes later ***</div>
            <p>Ding dong. I answer the door to see Malory.</p>
            <div class="dialogue-line"><span class="speaker">Heather:</span> â€œHi, Mal anyone else with you?â€</div>
            <div class="dialogue-line"><span class="speaker">Malory:</span> â€œNo. I read this in a book about mysteries some are true and it said what's going on isâ€”Ahhhhh Heather!!!!â€</div>
            <p>A large black arm from the sky grabbed her just when she was going to tell me what's going on.</p>
            <div class="dialogue-line"><span class="speaker">Heather & Hunter:</span> â€œMalory!!!!!â€</div>
            <div class="dialogue-line"><span class="speaker">Lemon:</span> (Face of horror ğŸ˜±)</div>

            <h2 style="text-align:center; margin-top:50px;">To Be Continued...</h2>
        `;

        let currentFontSize = 20;
        let currentPageIndex = 0;
        let pages = [];

        const visibleContent = document.getElementById('visible-content');
        const measureChamber = document.getElementById('measure-chamber');
        const viewport = document.getElementById('page-viewport'); // We use this for height limit
        const nextBtn = document.getElementById('btn-next');
        const prevBtn = document.getElementById('btn-prev');
        const pageNumDisplay = document.getElementById('page-num');
        const totalPagesDisplay = document.getElementById('total-pages');

        lucide.createIcons();

        function paginateContent() {
            // 1. Convert string HTML to DOM nodes
            const parser = new DOMParser();
            const doc = parser.parseFromString(rawStoryHTML, 'text/html');
            const elements = Array.from(doc.body.children);

            // 2. Reset
            pages = [];
            measureChamber.innerHTML = '';

            // 3. Get exact height of the viewing area
            // We use the VIEWPORT height (minus padding) as the hard limit
            const viewportStyle = window.getComputedStyle(viewport);
            const paddingTop = parseFloat(viewportStyle.paddingTop);
            const paddingBottom = parseFloat(viewportStyle.paddingBottom);

            // The max height is the container height MINUS the padding
            // (Because the measure chamber is placed INSIDE the padding box)
            const maxHeight = viewport.clientHeight - paddingTop - paddingBottom;

            let currentPageNodes = [];

            elements.forEach(el => {
                const clone = el.cloneNode(true);
                measureChamber.appendChild(clone);

                // 4. Compare scrollHeight (content) vs maxHeight (container limit)
                // We assume the chamber has no fixed height, so scrollHeight = total content height
                if (measureChamber.scrollHeight > maxHeight) {

                    // IF it doesn't fit...
                    if (currentPageNodes.length > 0) {
                        pages.push(currentPageNodes);
                    }

                    // Reset for next page
                    currentPageNodes = [];
                    measureChamber.innerHTML = '';
                    measureChamber.appendChild(clone); // Add the item that didn't fit to new page
                    currentPageNodes.push(el);
                } else {
                    // IF it fits...
                    currentPageNodes.push(el);
                }
            });

            if (currentPageNodes.length > 0) {
                pages.push(currentPageNodes);
            }

            measureChamber.innerHTML = '';

            if (currentPageIndex >= pages.length) currentPageIndex = pages.length - 1;
            renderPage();
        }

        function renderPage() {
            visibleContent.innerHTML = '';

            if (pages.length > 0) {
                const nodes = pages[currentPageIndex];
                nodes.forEach(node => {
                    visibleContent.appendChild(node.cloneNode(true));
                });
            }

            pageNumDisplay.innerText = currentPageIndex + 1;
            totalPagesDisplay.innerText = pages.length;

            prevBtn.disabled = currentPageIndex === 0;
            if (currentPageIndex >= pages.length - 1) {
                nextBtn.innerText = "End of Chapter";
                nextBtn.disabled = true;
                nextBtn.style.backgroundColor = "#888";
            } else {
                nextBtn.innerText = "Turn Page";
                nextBtn.disabled = false;
                nextBtn.style.backgroundColor = "var(--ink-color)";
            }
        }

        function turnPage(direction) {
            const newIndex = currentPageIndex + direction;
            if (newIndex >= 0 && newIndex < pages.length) {
                currentPageIndex = newIndex;
                renderPage();
            }
        }

        function resizeFont(delta) {
            currentFontSize += delta;
            if (currentFontSize < 14) currentFontSize = 14;
            if (currentFontSize > 32) currentFontSize = 32;
            document.documentElement.style.setProperty('--base-size', currentFontSize + 'px');
            setTimeout(paginateContent, 50);
        }

        // Wait for fonts/CSS to load to get accurate measurements
        window.onload = () => {
            paginateContent();
        };

        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(paginateContent, 100);
        });
    </script>
</body>
</html>